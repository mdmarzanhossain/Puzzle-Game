<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <style>
        .row{
            height: 100%;
        }
        .test{
            background-color: rgb(0, 0, 0) !important;
            color: rgb(255, 255, 255) !important;
            font-weight: bold !important;
        }
        .item-design{
            text-decoration: none;
            border: 5px solid lightgray;
            border-radius: 5px;
            padding: 50px;
            background-color: lightblue;
            font-weight: bold;
            color: black;
            height: 100px;
        }
        .show{
            display: none;
        }
    </style>
    
    <title>Puzzle Solve</title>
    <script src="js/jquery-3.5.0.js"></script>
</head>
<body>

<div class="container mt-5">
    <div class="row">
        <div class="offset-md-4 col-md-4">
            <label for="userInput" class="form-label mt-3">Enter Pair Value</label>
            <input type="number" class="form-control" id="userInput">
            <button id="userButton" class="btn btn-primary mt-3 mb-5">Submit</button>
        </div>
    </div>
    <div class="row">
        <div class="puzzle-items mb-5 mt-5 text-center">

        </div>
    </div>

    <div class="row">
        <div class="result"></div>
    </div>
</div>
<script>
    //image load
    const images = [];

    for(let i = 0; i < 8;i++){
        images[i] = new Image();
        images[0].src = `images/${i}.png`;
    }

    //puzzle item append
    function appendItem(userInput){
        const puzzleItemNumber = userInput * 2;
        let arrayOne = [];
        let arrayTwo = [];
        let j = 0,k = 0;
        
        for(let i = 0; i < puzzleItemNumber; i++){
            if(i % 6 === 0){
                k = j;
                $('.puzzle-items').append(`<div class='row row${j++} mb-4'><div class="col-md-2"><a id="${i+1}" class='item-design imgbtn mb-3'>${i+1}</a></div></div>`);
            }
            else{
                $(`.row${k}`).append(`<div class="col-md-2"><a id="${i+1}" class='item-design imgbtn mb-3'>${i+1}</a></div>`);
            }
             
        }

        arrayUniqueValueGenerate(arrayOne, userInput);
        arrayUniqueValueGenerate(arrayTwo, userInput);

        let mergeArray = $.merge(arrayOne,arrayTwo);
        //console.log("merged array: ", mergeArray);

        let shuffleArray = [];
        
        let finalArray = shuffle(shuffleArray, mergeArray);

        console.log("shuffle array: ", finalArray);
        
        let i = 0;
        $('.imgbtn').each(function(){
            $(this).attr('value', finalArray[i++]);
        })

        //play game

        $(".imgbtn").on('click', function(){
            //$(this).toggleClass('test');

            clickedValueStore($(this).attr('value'));

            let currentID = $(this).attr('id');
            let currentVal = $(this).attr('value');
            let htmlVal = $(this).html();
            console.log(currentID);

            // if($(this).attr('id') === currentID) {
            //     $(this).html(`<a><img src=./images/${currentVal-1}.png></a>`);
            // }else{
            //     $(this).html('');
            // }

            if($(this).html() === currentVal) {
                $(this).html(`<a><img src=./images/${currentVal-1}.png></a>`);
            }else{
                $(this).html(currentVal);
            }

            // $(`#${currentID}`).on("click", function (){
            //     $(this).remove();
            // })
            
            // 2 ta click hole check korbe then match korle class remove korbe. na korleo remove korbe.
            if($(".test").length === 2){
                //console.log("2 button clicked");
                if(pairArrayValue[0] === pairArrayValue[1]){
                    pairArrayValue = [];        //if pair match make array empty
                    console.log("value matched");
                    $(".imgbtn").removeClass("test");
                }
                else{
                    //$(".result").html("");
                    $(".imgbtn").removeClass("test");
                }
            }
            else{

            }
        });
    }

    var pairArrayValue = [];

    function clickedValueStore(value) {
        
        if(pairArrayValue.length < 2){
            pairArrayValue.push(value);
        }
        else{
            pairArrayValue = [];    // array value 2 er beshi hole empty kore dibe then value push korbe
            pairArrayValue.push(value);
        }
        console.log("pairArrayValue " + pairArrayValue);
        return pairArrayValue;
        
    }

    function shuffle(shuffleArray, mergeArray){
        let index = [];
        arrayUniqueValueGenerate(index, mergeArray.length);

       // console.log("index ",index);
        let i = 0;
        while(i < index.length){
            shuffleArray.push(mergeArray[index[i]-1]);
            i++;
        }
        //console.log(shuffleArray);
        return shuffleArray;
    }

    function arrayUniqueValueGenerate(array,arraySize){
        let i = 0;
        while(i < arraySize){
            let x = randomValueGenerate(arraySize);
            if(!array.includes(x)){
                array.push(x);
                i++;
            }
        }
    }

    function randomValueGenerate(userInput){
        let x = Math.floor((Math.random() * userInput) + 1);
        return x;
    }

    // user input submit

    $('#userButton').on('click',function(){
        $('.puzzle-items').html("");
        const userInput = $('#userInput').val();
        if(userInput < 0){
            alert('Please enter a positive number');
        }
        else if(userInput == 0 || userInput == 1){
            alert('Please enter a number greater than 1');
        }
        else{
            appendItem(userInput);
        }
    })
    
</script>
    <script src="js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
</body>
</html>